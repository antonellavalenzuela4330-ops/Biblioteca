<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gesti√≥n de Biblioteca</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Login Page -->
        <div id="loginPage" class="auth-container">
            <div class="auth-wrapper">
                <div class="auth-left" aria-hidden="true"></div>
                <div class="auth-right">
                    <div class="brand">
                        <img src="unnamed.png" alt="EVERTALES" class="brand-logo" />
                        <div class="brand-sep"></div>
                    </div>
                    <div class="auth-form auth-form-hero">
                        <h2 class="auth-heading">INICIAR SESI√ìN</h2>
                        <form id="loginForm">
                            <div class="form-group">
                                <label for="loginEmail" class="label-hero">EMAIL.</label>
                                <input type="email" id="loginEmail" class="input-hero" required>
                            </div>
                            <div class="form-group">
                                <label for="loginPassword" class="label-hero">CONTRASE√ëA</label>
                                <input type="password" id="loginPassword" class="input-hero" required>
                            </div>
                            <button type="submit" class="btn btn-hero">INICIAR SESI√ìN</button>
                        </form>
                        <div class="auth-links auth-links-hero">
                            <button type="button" class="link-btn" onclick="showRegisterPage()">CREAR UNA CUENTA</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Register Page -->
        <div id="registerPage" class="auth-container" style="display: none;">
            <div class="auth-wrapper">
                <div class="auth-left" aria-hidden="true"></div>
                <div class="auth-right">
                    <div class="brand">
                        <img src="unnamed.png" alt="EVERTALES" class="brand-logo" />
                        <div class="brand-sep"></div>
                    </div>
                    <div class="auth-form auth-form-hero">
                        <h2 class="auth-heading">CREAR CUENTA</h2>
                        <form id="registerForm">
                            <div class="form-group">
                                <label for="registerName" class="label-hero">NOMBRE COMPLETO</label>
                                <input type="text" id="registerName" class="input-hero" required>
                            </div>
                            <div class="form-group">
                                <label for="registerDni" class="label-hero">DNI</label>
                                <input type="text" id="registerDni" class="input-hero" required>
                            </div>
                            <div class="form-group">
                                <label for="registerAddress" class="label-hero">DIRECCI√ìN</label>
                                <input type="text" id="registerAddress" class="input-hero" required>
                            </div>
                            <div class="form-group">
                                <label for="registerPhone" class="label-hero">TEL√âFONO</label>
                                <input type="tel" id="registerPhone" class="input-hero" required>
                            </div>
                            <div class="form-group">
                                <label for="registerEmail" class="label-hero">EMAIL.</label>
                                <input type="email" id="registerEmail" class="input-hero" required>
                            </div>
                            <div class="form-group">
                                <label for="registerPassword" class="label-hero">CONTRASE√ëA</label>
                                <input type="password" id="registerPassword" class="input-hero" required>
                            </div>
                            
                            <button type="submit" class="btn btn-hero">REGISTRARME</button>
                        </form>
                        <div class="auth-links auth-links-hero">
                            <button type="button" class="link-btn" onclick="showLoginPage()">¬øYA TIENES UNA CUENTA? INICIA SESI√ìN</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Forgot Password Page -->
        <div id="forgotPasswordPage" class="auth-container" style="display: none;">
            <div class="auth-form">
                <h2>Recuperar Contrase√±a</h2>
                <p>Ingresa tu email para recibir instrucciones de recuperaci√≥n:</p>
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label for="forgotEmail">Email:</label>
                        <input type="email" id="forgotEmail" required>
                    </div>
                    <button type="submit" class="btn">Enviar Instrucciones</button>
                </form>
                <div class="auth-links">
                    <button class="link-btn" onclick="showLoginPage()">Volver al inicio de sesi√≥n</button>
                </div>
            </div>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <div class="dashboard-header">
                <!-- T√≠tulo din√°mico centrado -->
                <div class="welcome-title-container">
                    <h1 id="welcomeTitle" class="welcome-title">Bienvenido Usuario</h1>
                    <div class="welcome-subtitle" id="welcomeSubtitle">Sistema de Gesti√≥n de Biblioteca</div>
                </div>
                
                <button class="logout-btn" onclick="logout()">Cerrar Sesi√≥n</button>
            </div>

            <!-- Navigation -->
            <div class="nav-tabs">
                <!-- Pesta√±as Comunes -->
                <div id="tabCatalog" class="nav-tab active" onclick="showSection('catalog')">
                    <span class="nav-icon"></span>
                    <span class="nav-text">Cat√°logo</span>
                </div>
                <div class="nav-tab" onclick="showSection('search')">
                    <span class="nav-text">Buscar</span>
                </div>
                
                <!-- Pesta√±as de Usuario -->
                <div class="nav-tab user-loans-tab user-role-tab" onclick="showSection('userLoans')">
                    <span class="nav-text">Mis Pr√©stamos</span>
                </div>
                <div class="nav-tab user-profile-tab user-role-tab" onclick="showSection('userProfile')">
                    <span class="nav-text">Mi Perfil</span>
                </div>
                <div class="nav-tab user-tab user-role-tab" onclick="showSection('notifications')">
                    <span class="nav-text">Notificaciones</span>
                    <span id="notificationBadge" class="notification-badge" style="display: none;">0</span>
                </div>
                
                <!-- Pesta√±as de Bibliotecario -->
                <div class="nav-tab librarian-only librarian-role-tab" onclick="showSection('loans')">
                    <span class="nav-text">Pr√©stamos y Devoluciones</span>
                </div>
                
                <!-- Pesta√±as de Administrador -->
                <div class="nav-tab admin-only admin-role-tab" onclick="showSection('admin')">
                    <span class="nav-text">Administraci√≥n</span>
                </div>
                <div class="nav-tab admin-only admin-role-tab" onclick="showSection('users')">
                    <span class="nav-text">Usuarios</span>
                </div>
                <div class="nav-tab admin-only admin-role-tab" onclick="showSection('profiles')">
                    <span class="nav-text">Perfiles</span>
                </div>
                <div class="nav-tab admin-only admin-role-tab" onclick="showSection('stats')">
                    <span class="nav-text">Estad√≠sticas</span>
                </div>
            </div>

            <!-- Cat√°logo -->
            <div id="catalogSection" class="content-section active">
                <h2>Cat√°logo de Libros</h2>
                <div id="booksGrid" class="books-grid"></div>
            </div>

            <!-- Buscar -->
            <div id="searchSection" class="content-section">
                <h2>BUSCAR LIBRO</h2>
                <div class="search-container">
                    <div class="search-filters">
                        <input type="text" id="searchInput" class="search-input" placeholder="nombre del libro">
                        <select id="genreFilter" class="filter-select">
                            <option value="">G√âNERO</option>
                        </select>
                        <select id="editorialFilter" class="filter-select">
                            <option value="">EDITORIAL</option>
                        </select>
                        <select id="tutorFilter" class="filter-select">
                            <option value="">TUTOR</option>
                        </select>
                        <select id="statusFilter" class="filter-select">
                            <option value="">ESTADO</option>
                            <option value="disponible">Disponible</option>
                            <option value="agotado">Agotado</option>
                        </select>
                        <button class="btn" onclick="searchBooks()">BUSCAR</button>
                        <button class="btn btn-secondary" onclick="clearSearch()">LIMPIAR</button>
                    </div>
                </div>
                <div id="searchResults" class="books-grid"></div>
            </div>

            <!-- Mis Pr√©stamos (Para Usuarios) -->
            <div id="userLoansSection" class="content-section">
                <h2>MIS PR√âSTAMOS</h2>
                
                <!-- Formulario de Solicitud de Pr√©stamo -->
                <div class="admin-panel">
                    <h3>Solicitar Pr√©stamo</h3>
                    <form id="userLoanRequestForm" class="admin-form">
                        <select id="requestBook" required>
                            <option value="">Seleccionar libro</option>
                        </select>
                        <input type="number" id="requestQuantity" placeholder="Cantidad" min="1" max="3" required>
                        <input type="date" id="requestStartDate" required>
                        <input type="date" id="requestEndDate" required>
                        <button type="submit" class="btn">Solicitar Pr√©stamo</button>
                    </form>
                </div>

                <!-- Notificaciones -->
                <div id="userNotifications" class="notifications-container">
                    <h3>Notificaciones</h3>
                    <p>Aqu√≠ recibir√°s notificaciones sobre el estado de tus pr√©stamos, recordatorios de devoluci√≥n y actualizaciones importantes.</p>
                    <button class="btn btn-secondary" onclick="showSection('notifications')">Ver todas las notificaciones</button>
                </div>
            </div>

            <!-- Secci√≥n de Notificaciones -->
            <div id="notificationsSection" class="content-section">
                <div class="notifications-header">
                    <h2>NOTIFICACIONES</h2>
                    <div class="notification-actions">
                        <button class="btn btn-secondary" onclick="markAllAsRead()">Marcar todas como le√≠das</button>
                        <button class="btn btn-secondary" onclick="clearAllNotifications()">Limpiar todas</button>
                    </div>
                </div>
                
                <!-- Filtros de Notificaciones -->
                <div class="notification-filters">
                    <select id="notificationFilter" class="filter-select" onchange="filterNotifications()">
                        <option value="all">Todas las notificaciones</option>
                        <option value="unread">No le√≠das</option>
                        <option value="loan_approved">Pr√©stamos aprobados</option>
                        <option value="loan_rejected">Pr√©stamos rechazados</option>
                        <option value="return_completed">Devoluciones completadas</option>
                        <option value="return_reminder">Recordatorios de devoluci√≥n</option>
                        <option value="overdue">Libros vencidos</option>
                        <option value="user_suspended">Cuenta suspendida</option>
                        <option value="user_reactivated">Cuenta reactivada</option>
                        <option value="rating_update">Actualizaciones de calificaci√≥n</option>
                        <option value="system">Sistema</option>
                    </select>
                </div>

                <!-- Lista de Notificaciones -->
                <div id="notificationsList" class="notifications-list">
                    <!-- Las notificaciones se cargar√°n din√°micamente aqu√≠ -->
                </div>

                <!-- Mensaje cuando no hay notificaciones -->
                <div id="noNotificationsMessage" class="no-notifications" style="display: none;">
                    <div class="no-notifications-icon"></div>
                    <h3>No tienes notificaciones</h3>
                    <p>Cuando tengas notificaciones sobre tus pr√©stamos, aparecer√°n aqu√≠.</p>
                </div>
            </div>

            <!-- Perfil de Usuario -->
            <div id="userProfileSection" class="content-section">
                <h2>MI PERFIL</h2>
                <div class="profile-container">
                    <!-- Informaci√≥n Personal -->
                    <div class="profile-card">
                        <h3>Informaci√≥n Personal</h3>
                        <div class="profile-info">
                            <div class="info-item">
                                <span class="info-label">Nombre:</span>
                                <span id="profileName" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Email:</span>
                                <span id="profileEmail" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">DNI:</span>
                                <span id="profileDni" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Direcci√≥n:</span>
                                <span id="profileAddress" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Tel√©fono:</span>
                                <span id="profilePhone" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Rol:</span>
                                <span id="profileRole" class="info-value">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Estad√≠sticas de Pr√©stamos -->
                    <div class="profile-card">
                        <h3>Estad√≠sticas de Pr√©stamos</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-icon">üìö</div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalLoans">0</div>
                                    <div class="stat-label">Pr√©stamos Totales</div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">‚úÖ</div>
                                <div class="stat-content">
                                    <div class="stat-number" id="booksGoodState">0</div>
                                    <div class="stat-label">Devueltos en Buen Estado</div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">‚ö†Ô∏è</div>
                                <div class="stat-content">
                                    <div class="stat-number" id="booksRegularState">0</div>
                                    <div class="stat-label">Devueltos en Estado Regular</div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">‚ùå</div>
                                <div class="stat-content">
                                    <div class="stat-number" id="booksBadState">0</div>
                                    <div class="stat-label">Devueltos en Mal Estado</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sistema de Puntos -->
                    <div class="profile-card">
                        <h3>Sistema de Puntos</h3>
                        <div class="points-container">
                            <div class="points-display">
                                <div class="points-number" id="userPoints">0</div>
                                <div class="points-label">Puntos Acumulados</div>
                            </div>
                            <div class="points-breakdown">
                                <div class="points-item">
                                    <span class="points-source">Libros en buen estado:</span>
                                    <span class="points-value" id="pointsGoodState">0 pts</span>
                                </div>
                                <div class="points-item">
                                    <span class="points-source">Libros en estado regular:</span>
                                    <span class="points-value" id="pointsRegularState">0 pts</span>
                                </div>
                                <div class="points-item">
                                    <span class="points-source">Libros en mal estado:</span>
                                    <span class="points-value" id="pointsBadState">0 pts</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Nivel de Confiabilidad -->
                    <div class="profile-card">
                        <h3>Nivel de Confiabilidad</h3>
                        <div class="reliability-container">
                            <div class="reliability-score" id="userReliabilityScore">100</div>
                            <div class="reliability-bar">
                                <div class="reliability-fill" id="reliabilityBar"></div>
                            </div>
                            <div class="reliability-status" id="reliabilityStatus">Excelente</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Administraci√≥n -->
            <div id="adminSection" class="content-section">
                <h2>GESTI√ìN DE BIBLIOTECA</h2>
                <div class="admin-panel">
                    <h3>Gesti√≥n de Libros</h3>
                    <form id="bookForm" class="admin-form">
                        <input type="text" id="bookTitle" placeholder="T√≠tulo del libro" required>
                        <input type="text" id="bookAuthor" placeholder="Autor" required>
                        <input type="text" id="bookGenre" placeholder="G√©nero" required>
                        <input type="text" id="bookEditorial" placeholder="Editorial" required>
                        <input type="text" id="bookTutor" placeholder="Tutor/Acad√©mico" required>
                        <input type="number" id="bookYear" placeholder="A√±o de publicaci√≥n" required min="1000" max="2024">
                        <input type="number" id="bookStock" placeholder="Stock disponible" required min="0">
                        <input type="text" id="bookIsbn" placeholder="ISBN" required>
                        <textarea id="bookDescription" placeholder="Descripci√≥n del libro" rows="3"></textarea>
                        <button type="submit" class="btn">Guardar Libro</button>
                    </form>
                </div>
                <div id="adminAlerts"></div>
                <div id="inventoryTable"></div>
            </div>

            <!-- Gesti√≥n de Pr√©stamos y Devoluciones -->
            <div id="loansSection" class="content-section">
                <h2>GESTI√ìN DE PR√âSTAMOS Y DEVOLUCIONES</h2>
                
                <!-- Nuevo Pr√©stamo -->
                <div class="admin-panel">
                    <h3>Nuevo Pr√©stamo</h3>
                    <form id="loanForm" class="admin-form">
                        <select id="loanBook" required>
                            <option value="">LIBRO</option>
                        </select>
                        <select id="loanUser" required>
                            <option value="">USUARIO</option>
                        </select>
                        <input type="number" id="loanQuantity" placeholder="CANTIDAD" min="1" required>
                        <input type="date" id="loanDate" placeholder="fecha" required>
                        <input type="date" id="returnDate" placeholder="fecha dev" required>
                        <button type="submit" class="btn">CREAR PR√âSTAMO</button>
                    </form>
                </div>

                <!-- Devoluci√≥n Normal -->
                <div class="admin-panel">
                    <h3>Registrar Devoluci√≥n</h3>
                    <form id="returnForm" class="admin-form">
                        <select id="returnUser" required>
                            <option value="">SELECCIONAR USUARIO</option>
                        </select>
                        <input type="text" id="returnIsbn" placeholder="C√ìDIGO ISBN" required>
                        <select id="returnCondition" required>
                            <option value="">ESTADO DEL LIBRO</option>
                            <option value="buen_estado">Buen Estado</option>
                            <option value="estado_regular">Estado Regular</option>
                            <option value="mal_estado">Mal Estado</option>
                        </select>
                        <input type="date" id="returnDate" required>
                        <textarea id="returnNotes" placeholder="Observaciones (opcional)" rows="2"></textarea>
                        <button type="submit" class="btn">REGISTRAR DEVOLUCI√ìN</button>
                    </form>
                </div>

                <!-- Libros No Devueltos -->
                <div class="admin-panel">
                    <h3>Registrar Libro No Devuelto</h3>
                    <form id="notReturnedForm" class="admin-form">
                        <select id="notReturnedUser" required>
                            <option value="">SELECCIONAR USUARIO</option>
                        </select>
                        <input type="text" id="notReturnedIsbn" placeholder="C√ìDIGO ISBN" required>
                        <select id="notReturnedReason" required>
                            <option value="">MOTIVO</option>
                            <option value="no_devuelto">No Devuelto</option>
                            <option value="devuelto_tarde">Devuelto Fuera de Tiempo</option>
                            <option value="perdido">Libro Perdido</option>
                            <option value="da√±ado_irreparable">Da√±ado Irreparable</option>
                        </select>
                        <input type="date" id="notReturnedDate" required>
                        <textarea id="notReturnedNotes" placeholder="Observaciones" rows="2" required></textarea>
                        <button type="submit" class="btn btn-warning">REGISTRAR NO DEVUELTO</button>
                    </form>
                </div>

                <!-- Lista de Pr√©stamos Activos -->
                <div class="admin-panel">
                    <h3>Pr√©stamos Activos</h3>
                    <div id="loansList" class="loansList"></div>
                </div>

                <!-- Control de Stock por Estado -->
                <div class="admin-panel">
                    <h3>Control de Stock por Estado</h3>
                    <div class="stock-controls">
                        <button class="btn" onclick="updateBookAvailability()">ACTUALIZAR DISPONIBILIDAD</button>
                        <button class="btn btn-secondary" onclick="generateStockReport()">GENERAR REPORTE DE STOCK</button>
                    </div>
                    <div id="stockStatus" class="stock-status"></div>
                </div>

                <!-- Lista de Devoluciones -->
                <div class="admin-panel">
                    <h3>Historial de Devoluciones</h3>
                    <div id="returnsList" class="returns-list"></div>
                </div>

                <!-- Libros No Devueltos -->
                <div class="admin-panel">
                    <h3>Libros No Devueltos</h3>
                    <div id="notReturnedList" class="not-returned-list"></div>
                </div>
            </div>

            <!-- Usuarios -->
            <div id="usersSection" class="content-section">
                <h2>GESTI√ìN DE USUARIOS</h2>
                
                <!-- Subsecci√≥n: Agregar Usuarios -->
                <div class="admin-panel">
                    <h3>AGREGAR NUEVO USUARIO</h3>
                    <form id="userForm" class="admin-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userName">Nombre completo:</label>
                                <input type="text" id="userName" placeholder="Nombre completo" required>
                            </div>
                            <div class="form-group">
                                <label for="userEmail">Email:</label>
                                <input type="email" id="userEmail" placeholder="Email" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userPassword">Contrase√±a:</label>
                                <input type="password" id="userPassword" placeholder="Contrase√±a" required>
                            </div>
                            <div class="form-group">
                                <label for="userDni">DNI:</label>
                                <input type="text" id="userDni" placeholder="DNI" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userPhone">Tel√©fono:</label>
                                <input type="text" id="userPhone" placeholder="Tel√©fono" required>
                            </div>
                            <div class="form-group">
                                <label for="userAddress">Direcci√≥n:</label>
                                <input type="text" id="userAddress" placeholder="Direcci√≥n" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userRole">Rol:</label>
                                <select id="userRole" required>
                                    <option value="">Seleccionar rol</option>
                                    <option value="usuario">Usuario</option>
                                    <option value="bibliotecario">Bibliotecario</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="userStatus">Estado:</label>
                                <select id="userStatus" required>
                                    <option value="">Seleccionar estado</option>
                                    <option value="activo">Activo</option>
                                    <option value="inactivo">Inactivo</option>
                                    <option value="suspendido">Suspendido</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn">AGREGAR USUARIO</button>
                    </form>
                </div>

                <!-- Subsecci√≥n: Editar Usuarios -->
                <div class="admin-panel">
                    <h3>EDITAR USUARIOS EXISTENTES</h3>
                    <p>Selecciona un usuario de la lista para editarlo:</p>
                    <div id="usersTable" class="usersTable"></div>
                </div>
            </div>

            <!-- Perfiles de Usuarios -->
            <div id="profilesSection" class="content-section">
                <h2>PERFILES DE USUARIOS</h2>
                
                <!-- B√∫squeda de Usuario -->
                <div class="admin-panel">
                    <h3>Buscar Perfil de Usuario</h3>
                    <div class="search-profile">
                        <select id="profileUserSelect">
                            <option value="">Seleccionar usuario para ver perfil</option>
                        </select>
                        <button class="btn" onclick="loadUserProfile()">VER PERFIL</button>
                    </div>
                </div>

                <!-- Perfil del Usuario Seleccionado -->
                <div id="userProfileContainer" class="user-profile-container" style="display: none;">
                    <div class="profile-header">
                        <h3 id="profileUserName">Nombre del Usuario</h3>
                        <div class="profile-actions">
                            <button class="btn" onclick="suspendUser()" id="suspendBtn">SUSPENDER</button>
                            <button class="btn btn-secondary" onclick="reactivateUser()" id="reactivateBtn">REACTIVAR</button>
                        </div>
                    </div>
                    
                    <div class="profile-content">
                        <!-- Informaci√≥n B√°sica -->
                        <div class="profile-section">
                            <h4>Informaci√≥n B√°sica</h4>
                            <div class="profile-info">
                                <div class="info-item">
                                    <strong>DNI:</strong> <span id="profileDni">-</span>
                                </div>
                                <div class="info-item">
                                    <strong>Email:</strong> <span id="profileEmail">-</span>
                                </div>
                                <div class="info-item">
                                    <strong>Tel√©fono:</strong> <span id="profilePhone">-</span>
                                </div>
                                <div class="info-item">
                                    <strong>Direcci√≥n:</strong> <span id="profileAddress">-</span>
                                </div>
                                <div class="info-item">
                                    <strong>Estado:</strong> <span id="profileStatus" class="status-badge">-</span>
                                </div>
                                <div class="info-item">
                                    <strong>Fecha de Registro:</strong> <span id="profileCreatedAt">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Confiabilidad -->
                        <div class="profile-section">
                            <h4>Confiabilidad</h4>
                            <div class="reliability-info">
                                <div class="reliability-score">
                                    <div class="score-circle">
                                        <span id="reliabilityScore">100</span>
                                        <div class="score-label">Puntos</div>
                                    </div>
                                    <div class="reliability-level">
                                        <span id="reliabilityLevel">Excelente</span>
                                        <div class="level-description">Nivel de Confiabilidad</div>
                                    </div>
                                </div>
                                <div class="reliability-breakdown">
                                    <div class="breakdown-item good">
                                        <span class="breakdown-label">Buenas Devoluciones:</span>
                                        <span class="breakdown-value" id="goodReturns">0</span>
                                    </div>
                                    <div class="breakdown-item regular">
                                        <span class="breakdown-label">Devoluciones Regulares:</span>
                                        <span class="breakdown-value" id="regularReturns">0</span>
                                    </div>
                                    <div class="breakdown-item bad">
                                        <span class="breakdown-label">Malas Devoluciones:</span>
                                        <span class="breakdown-value" id="badReturns">0</span>
                                    </div>
                                    <div class="breakdown-item not-returned">
                                        <span class="breakdown-label">No Devueltos:</span>
                                        <span class="breakdown-value" id="notReturned">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Estad√≠sticas de Pr√©stamos -->
                        <div class="profile-section">
                            <h4>Estad√≠sticas de Pr√©stamos</h4>
                            <div class="loan-stats">
                                <div class="stat-item">
                                    <div class="stat-number" id="totalLoansCount">0</div>
                                    <div class="stat-label">Total de Pr√©stamos</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number" id="activeLoansCount">0</div>
                                    <div class="stat-label">Pr√©stamos Activos</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number" id="completedLoansCount">0</div>
                                    <div class="stat-label">Pr√©stamos Completados</div>
                                </div>
                            </div>
                        </div>

                        <!-- Actividad Reciente -->
                        <div class="profile-section">
                            <h4>Actividad Reciente</h4>
                            <div id="recentActivity" class="recent-activity">
                                <!-- Se llena din√°micamente -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lista de Usuarios con Confiabilidad -->
                <div class="admin-panel">
                    <h3>Usuarios por Confiabilidad</h3>
                    <div id="usersReliabilityList" class="users-reliability-list">
                        <!-- Se llena din√°micamente -->
                    </div>
                </div>
            </div>

            <!-- Estad√≠sticas -->
            <div id="statsSection" class="content-section">
                <h2>ESTAD√çSTICAS DE BIBLIOTECA</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Libros</h3>
                        <div class="stat-number" id="totalBooks">0</div>
                        <div class="stat-label">Total en cat√°logo</div>
                    </div>
                    <div class="stat-card">
                        <h3>Disponibles</h3>
                        <div class="stat-number" id="availableBooks">0</div>
                        <div class="stat-label">En stock</div>
                    </div>
                    <div class="stat-card">
                        <h3>Pr√©stamos</h3>
                        <div class="stat-number" id="totalLoans">0</div>
                        <div class="stat-label">Total realizados</div>
                    </div>
                    <div class="stat-card">
                        <h3>Activos</h3>
                        <div class="stat-number" id="activeLoans">0</div>
                        <div class="stat-label">En curso</div>
                    </div>
                    <div class="stat-card">
                        <h3>Usuarios</h3>
                        <div class="stat-number" id="totalUsers">0</div>
                        <div class="stat-label">Registrados</div>
                    </div>
                    <div class="stat-card">
                        <h3>Activos</h3>
                        <div class="stat-number" id="activeUsers">0</div>
                        <div class="stat-label">Usuarios activos</div>
                    </div>
                </div>
                <div class="stats-charts">
                    <div class="chart-container">
                        <h3>Libros por G√©nero</h3>
                        <div id="genreChart"></div>
                    </div>
                    <div class="chart-container">
                        <h3>Pr√©stamos por Mes</h3>
                        <div id="loansChart"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para agregar/editar libros -->
    <div id="bookModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBookModal()">&times;</span>
            <h2 id="modalTitle">Agregar Nuevo Libro</h2>
            <form id="modalBookForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalBookTitle">T√≠tulo:</label>
                        <input type="text" id="modalBookTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="modalBookAuthor">Autor:</label>
                        <input type="text" id="modalBookAuthor" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalBookGenre">G√©nero:</label>
                        <input type="text" id="modalBookGenre" required>
                    </div>
                    <div class="form-group">
                        <label for="modalBookEditorial">Editorial:</label>
                        <input type="text" id="modalBookEditorial" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalBookTutor">Tutor/Acad√©mico:</label>
                        <input type="text" id="modalBookTutor" required>
                    </div>
                    <div class="form-group">
                        <label for="modalBookYear">A√±o:</label>
                        <input type="number" id="modalBookYear" required min="1000" max="2024">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalBookStock">Stock:</label>
                        <input type="number" id="modalBookStock" required min="0">
                    </div>
                    <div class="form-group">
                        <label for="modalBookIsbn">ISBN:</label>
                        <input type="text" id="modalBookIsbn" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="modalBookDescription">Descripci√≥n:</label>
                    <textarea id="modalBookDescription" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">Guardar</button>
                    <button type="button" class="btn btn-secondary" onclick="closeBookModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para editar usuarios -->
    <div id="userEditModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeUserEditModal()">&times;</span>
            <h2 id="userEditModalTitle">Editar Usuario</h2>
            <form id="userEditForm">
                <input type="hidden" id="editUserId" value="">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editUserName">Nombre completo:</label>
                        <input type="text" id="editUserName" required>
                    </div>
                    <div class="form-group">
                        <label for="editUserEmail">Email:</label>
                        <input type="email" id="editUserEmail" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editUserPassword">Contrase√±a:</label>
                        <input type="password" id="editUserPassword" placeholder="Dejar vac√≠o para mantener la actual">
                    </div>
                    <div class="form-group">
                        <label for="editUserDni">DNI:</label>
                        <input type="text" id="editUserDni" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editUserPhone">Tel√©fono:</label>
                        <input type="text" id="editUserPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="editUserAddress">Direcci√≥n:</label>
                        <input type="text" id="editUserAddress" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editUserRole">Rol:</label>
                        <select id="editUserRole" required>
                            <option value="usuario">Usuario</option>
                            <option value="bibliotecario">Bibliotecario</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editUserStatus">Estado:</label>
                        <select id="editUserStatus" required>
                            <option value="activo">Activo</option>
                            <option value="inactivo">Inactivo</option>
                            <option value="suspendido">Suspendido</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">Guardar Cambios</button>
                    <button type="button" class="btn btn-secondary" onclick="closeUserEditModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="script.js"></script>
</body>
</html>